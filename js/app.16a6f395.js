(function(){var e={7645:function(){},8204:function(e,t){"use strict";var o=Date.now();t["Z"]=(e="uuid")=>(++o,`${e}-${o}-${Date.now()}`)},1264:function(e,t,o){"use strict";var r=o(144),i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"p-6 flex flex-col min-h-screen",attrs:{id:"app"}},[o("HeadingComponent",{staticClass:"text-center",attrs:{level:"1"}},[e._v("TYOV ~ Companion")]),o("NotificationPane"),o("div",{staticClass:"flex flex-col md:flex-row flex-grow"},[o("div",{staticClass:"flex-1"},[o("SlideDownPanelComponent",{staticClass:"flex-1",scopedSlots:e._u([{key:"closed-heading",fn:function(){return[e._v(" Open Actions ")]},proxy:!0}])},[o("ActionsPane"),o("PromptsPane")],1),o("div",{staticClass:"flex-1"},[o("MemoriesPane")],1)],1),o("div",{staticClass:"flex-1"},[o("MarksPane"),o("SkillsPane"),o("ResourcesPane"),o("CharactersPane")],1)]),o("div",{staticClass:"border-t mt-4 text-right"},[o("ul",[o("li",[o("a",{staticClass:"hover:text-gray-400",attrs:{href:"https://www.version1.net/"},domProps:{innerHTML:e._s(e.copyright)}})]),o("li",[o("a",{staticClass:"hover:text-gray-400",attrs:{href:"https://thousandyearoldvampire.com/"},domProps:{innerHTML:e._s("Thousand Year Old Vampire Copyright &copy; Tim Hutchings")}})])])])],1)},n=[],a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("CardComponent",{attrs:{id:"actions"}},[o("HeadingComponent",{attrs:{level:"2"}},[e._v("Actions")]),o("div",{staticClass:"m-2 text-center"},[o("div",{staticClass:"grid grid-cols-2 grid-rows-2 gap2"},[o("span",{staticClass:"text-gray-300 dark:text-gray-500"},[e._v("Last roll:")]),o("span",[e._v("Current roll: ")]),o("span",{staticClass:"text-gray-300 dark:text-gray-500"},[e._v(e._s(e.lastRoll))]),o("span",[e._v(e._s(e.currentRoll))])]),o("ButtonComponent",{staticClass:"w-full my-2",attrs:{type:"primary"},on:{click:e.roll}},[e._v(" Roll ")])],1),o("SaveMenuComponent"),o("LoadMenuComponent")],1)},s=[],l=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"m-4 p-4 border rounded border-gray-100 shadow-md hover:shadow-xl transition-all"},[e._t("default")],2)},d=[],c={name:"CardComponent"},u=c,m=o(1001),p=(0,m.Z)(u,l,d,!1,null,null,null),g=p.exports,h=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("button",{staticClass:"py-1 px-4 rounded transition-colors focus:outline-none focus:ring-2 ring-0",class:e.typeClasses,on:{click:function(t){return e.$emit("click")}}},[e._t("default")],2)},y=[];const v={default:{"bg-gray-200":!0,"hover:bg-gray-400":!0,"ring-gray-100":!0},primary:{"bg-red-700":!0,"hover:bg-red-900":!0,"text-white":!0,"ring-red-600":!0},secondary:{"bg-indigo-400":!0,"hover:bg-indigo-600":!0,"text-white":!0,"ring-indigo-300":!0}};var f={name:"ButtonComponent",props:{type:{type:String,default:"default",valiator:e=>v.keys().includes(e)}},computed:{typeClasses(){return v[this.type]}}},C=f,w=(0,m.Z)(C,h,y,!1,null,null,null),k=w.exports;const x=[{"text-3xl":!0},{"text-2xl":!0},{"text-xl":!0},{"text-base":!0},{"text-sm":!0},{"text-sm":!0}];var _,b,M={name:"HeadingComponent",functional:!0,props:{level:{type:String,default:"1",validator:e=>["1","2","3","4","5","6"].includes(e)}},render:function(e,t){const o=t.data.class||{};return t.data.staticClass&&(o[t.data.staticClass]=!0),e(`h${t.props.level}`,{...t.data,class:{"font-semibold":!0,"leading-loose":!0,"tracking-widest":!0,"text-indigo-800":!0,...o,...x[t.props.level-1]}},t.children)}},A=M,E=(0,m.Z)(A,_,b,!1,null,null,null),P=E.exports,R=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("SlideDownPanelComponent",{scopedSlots:e._u([{key:"closed-heading",fn:function(){return[e._v(" Save ")]},proxy:!0}]),model:{value:e.saving,callback:function(t){e.saving=t},expression:"saving"}},[o("div",{staticClass:"grid grid-rows gap-1 my-2"},[o("a",{ref:"download",staticClass:"hidden",attrs:{download:"save-game",target:"_blank",href:"about:blank"}}),o("ButtonComponent",{staticClass:"w-full",on:{click:e.toFile}},[e._v(" To File ")]),e.supportsLocalStorage?o("ButtonComponent",{staticClass:"w-full",on:{click:e.toLocalStorage}},[e._v(" To Local Storage ")]):e._e()],1)])},S=[],D=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{class:e.classes},[o("ButtonComponent",{staticClass:"w-full",attrs:{type:e.type},on:{click:e.toggle}},[e.shouldShow?e._t("open-heading",(function(){return[e._v(" Close ")]})):e._t("closed-heading",(function(){return[e._v(" Show ")]}))],2),e.shouldShow?e._t("default"):e._e()],2)},N=[],$={name:"SlideDownPanelComponent",model:{prop:"open",event:"change"},props:{open:{type:Boolean,default:!1}},data(){return{isOpen:this.open}},components:{ButtonComponent:k},computed:{shouldShow(){return this.isOpen},type(){return this.shouldShow?"secondary":"default"},classes(){return{"my-2":!0,"transition-all":!0,"p-4":this.shouldShow,border:this.shouldShow,rounded:this.shouldShow,"border-indigo-200":this.shouldShow,"shadow-md":this.shouldShow,"hover:shadow-xl":this.shouldShow}}},methods:{toggle(){this.isOpen=!this.isOpen,this.$emit("change",this.isOpen)}},watch:{open(e){this.isOpen=e}}},O=$,T=(0,m.Z)(O,D,N,!1,null,null,null),F=T.exports,Z=(o(2801),o(7327));class I{constructor(){(0,Z.Z)(this,"migrations",[])}async gatherMigrations(e){const t=[],o=this.migrations.length;for(let r=0;r<o;r++){const o=this.migrations[r],i=await o(e);i&&t.push(i.default)}return t}async migrate(e){if(e.__SIGNATURE__===B)return e;const t=await this.gatherMigrations(e.__SIGNATURE__);return t.sort(((e,t)=>e.requiredSignature||t.requiredSignature?!e.requiredSignature&&t.requiredSignature||e.requiredSignature&&t.requiredSignature&&e.requiredSignature>t.requiredSignature?1:e.requiredSignature&&!t.requiredSignature||e.requiredSignature&&t.requiredSignature&&e.requiredSignature<t.requiredSignature?-1:0:0)),t.forEach((t=>{t.requiredSignature?(console.info(`Running Migration: ${t.description}`),e=t.migrate(e)):console.warn(`Skipping migration with missing signature.  Description: ${t.description}`)})),e}register(...e){e.forEach((e=>{this.migrations.push(e)}))}unregister(...e){e.forEach((e=>{const t=this.migrations.indexOf(e);this.migrations.splice(t,1)}))}}const U=new I;U.register((async e=>e<1&&o.e(46).then(o.bind(o,9046))),(async e=>e<1&&o.e(896).then(o.bind(o,7896))),(async e=>e<1&&o.e(758).then(o.bind(o,4758))),(async e=>e<1&&o.e(572).then(o.bind(o,572))),(async e=>e<1&&o.e(322).then(o.bind(o,3322))),(async e=>e<1&&o.e(366).then(o.bind(o,9366))),(async e=>e<2&&o.e(250).then(o.bind(o,4250))));var H=U;const B=2,L=e=>({d6:e.state.actions.d6,d10:e.state.actions.d10,lastRoll:e.state.actions.lastRoll,prompts:e.state.actions.prompts,currentPromptIdx:e.state.actions.currentPromptIdx,characters:e.state.characters.characters,marks:e.state.marks.marks,memories:e.state.memories.memories,events:e.state.memories.events,resources:e.state.resources.resources,diaries:e.state.resources.diaries,skills:e.state.skills.skills,__SIGNATURE__:B}),Y=e=>{const t={actions:{d6:NaN,d10:NaN,lastRoll:"?",currentPromptIdx:0,prompts:[]},characters:{characters:[]},marks:{marks:[]},memories:{memories:[],events:[]},skills:{skills:[]},resources:{resources:[],diaries:[]}};return e?{...t[e]??{}}:{...t.actions,...t.characters,...t.marks,...t.memories,...t.resources,...t.skills}},q=async(e,t)=>{t={...Y(),...t},t=await H.migrate(t),e.commit("actions/saveRoll",t.lastRoll??"?"),e.commit("actions/setD6",t.d6??NaN),e.commit("actions/setD6",t.d6??NaN),e.commit("actions/setCurrentPromptIdx",t.currentPromptIdx??0);const o=Array.isArray(t.prompts)?t.prompts:[];o.forEach((e=>{e.page=parseInt(e.page,10),e.count=parseInt(e.count,10)})),e.commit("actions/setPrompts",o),e.commit("characters/set",Array.isArray(t.characters)?t.characters:[]),e.commit("marks/set",Array.isArray(t.marks)?t.marks:[]),e.commit("memories/setMemories",Array.isArray(t.memories)?t.memories:[]),e.commit("memories/setEvents",Array.isArray(t.events)?t.events:[]),e.commit("resources/setResources",Array.isArray(t.resources)?t.resources:[]),e.commit("resources/setDiaries",Array.isArray(t.diaries)?t.diaries:[]),e.commit("skills/set",Array.isArray(t.skills)?t.skills:[])},j=e=>{let t;try{t=JSON.stringify(e)}catch(i){throw"Unable to serialize data structure."}const o=t.length,r=new Uint16Array(o);for(let n=0;n<o;n++)r[n]=t.charCodeAt(n);return btoa(String.fromCharCode(...new Uint8Array(r.buffer)))},J=e=>{const t=atob(e),o=t.length,r=new Uint8Array(o);for(let n=0;n<o;n++)r[n]=t.charCodeAt(n);try{return JSON.parse(String.fromCharCode(...new Uint16Array(r.buffer)))}catch(i){throw"Unable to parse deserialised data."}},z=()=>{var e=window.localStorage;try{var t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(o){return o instanceof DOMException&&(22===o.code||1014===o.code||"QuotaExceededError"===o.name||"NS_ERROR_DOM_QUOTA_REACHED"===o.name)&&e&&0!==e.length}},G=(e,t)=>{"string"!==typeof t&&(t=JSON.stringify(t)),window.localStorage.setItem(e,t)},Q=e=>{let t=window.localStorage.getItem(e);if(null===t)return null;try{return JSON.parse(t)}catch{return t}};var V={set:G,get:Q,supported:z},K={name:"SaveMenuComponent",data(){return{saving:!1}},components:{SlideDownPanelComponent:F,ButtonComponent:k},computed:{supportsLocalStorage:z},methods:{toFile(){const e=j(L(this.$store));this.$refs.download.href=URL.createObjectURL(new Blob([e],{type:"text/plain"})),this.$refs.download.click(),this.saving=!1},toLocalStorage(){const e=j(L(this.$store));V.set("save-game",e),this.saving=!1}}},W=K,X=(0,m.Z)(W,R,S,!1,null,null,null),ee=X.exports,te=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("SlideDownPanelComponent",{scopedSlots:e._u([{key:"closed-heading",fn:function(){return[e._v(" Load ")]},proxy:!0}]),model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},[o("div",{staticClass:"grid grid-rows gap-1 my-2"},[o("input",{ref:"upload",staticClass:"hidden",attrs:{type:"file"},on:{change:e.load}}),o("ButtonComponent",{staticClass:"w-full",on:{click:function(t){return e.$refs.upload.click()}}},[e._v(" From File ")]),e.supportsLocalStorage?o("ButtonComponent",{staticClass:"w-full",on:{click:e.fromLocalStorage}},[e._v(" From Local Storage ")]):e._e()],1)])},oe=[],re=o(629),ie={name:"SaveMenuComponent",data(){return{loading:!1}},components:{ButtonComponent:k,SlideDownPanelComponent:F},computed:{supportsLocalStorage:z},methods:{...(0,re.OI)("notifications",["hide"]),...(0,re.nv)("notifications",["showNotification"]),load(){if(1!==this.$refs.upload.files.length)return void this.showNotification({message:"Unable to load file.  You must select one file to load.",type:"warning"});this.hide();const e=this.$refs.upload.files[0],t=new FileReader;t.readAsText(e),t.onload=()=>{try{const e=J(t.result);q(this.$store,e)}catch(e){this.showNotification({message:"Unable to decode save state.",type:"danger"})}this.loading=!1},t.onerror=()=>{this.showNotification({message:"Unable to read file.",type:"danger"})}},fromLocalStorage(){this.hide();try{const e=J(V.get("save-game"));q(this.$store,e)}catch(e){this.showNotification({message:"Unable to decode save state.",type:"danger"})}this.loading=!1}}},ne=ie,ae=(0,m.Z)(ne,te,oe,!1,null,null,null),se=ae.exports,le={name:"ActionsPane",components:{ButtonComponent:k,CardComponent:g,HeadingComponent:P,SaveMenuComponent:ee,LoadMenuComponent:se},computed:{...(0,re.Se)("actions",["die","currentRoll"]),...(0,re.rn)("actions",["d6","d10","lastRoll"])},methods:{...(0,re.nv)("actions",["roll"])}},de=le,ce=(0,m.Z)(de,a,s,!1,null,null,null),ue=ce.exports,me=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("CardComponent",{attrs:{id:"characters"}},[o("HeadingComponent",{attrs:{level:"2"}},[e._v("Characters")]),o("FormToggleComponent",{attrs:{"show-controls":e.showAddingControls},on:{save:e.validatedAdd,toggle:e.toggleAddingControls},scopedSlots:e._u([{key:"button",fn:function(){return[e._v(" Add a new Character? ")]},proxy:!0},{key:"form",fn:function(){return[o("input",{directives:[{name:"model",rawName:"v-model",value:e.newCharacter.name,expression:"newCharacter.name"}],staticClass:"shadow appearance-none border rounded w-full py-1 px-2 m-1 text-gray-700 leading-tight focus:outline-none focus:ring-2 ring-gray-200",attrs:{type:"text",placeholder:"Name"},domProps:{value:e.newCharacter.name},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.validatedAdd.apply(null,arguments)},input:function(t){t.target.composing||e.$set(e.newCharacter,"name",t.target.value)}}}),o("textarea",{directives:[{name:"model",rawName:"v-model",value:e.newCharacter.bio,expression:"newCharacter.bio"}],staticClass:"shadow appearance-none border rounded w-full py-1 px-2 m-1 text-gray-700 leading-tight focus:outline-none focus:ring-2 ring-gray-200 resize-none",attrs:{placeholder:"Bio"},domProps:{value:e.newCharacter.bio},on:{input:function(t){t.target.composing||e.$set(e.newCharacter,"bio",t.target.value)}}}),e._v(" "),o("label",[o("input",{directives:[{name:"model",rawName:"v-model",value:e.newCharacter.immortal,expression:"newCharacter.immortal"}],staticClass:"shadow border rounded py-2 px-2 m-1 text-gray-700 leading-tight focus:outline-none focus:ring-2 ring-gray-200",attrs:{type:"checkbox","true-value":!0,"false-value":!1},domProps:{checked:Array.isArray(e.newCharacter.immortal)?e._i(e.newCharacter.immortal,null)>-1:e.newCharacter.immortal},on:{change:function(t){var o=e.newCharacter.immortal,r=t.target,i=!!r.checked;if(Array.isArray(o)){var n=null,a=e._i(o,n);r.checked?a<0&&e.$set(e.newCharacter,"immortal",o.concat([n])):a>-1&&e.$set(e.newCharacter,"immortal",o.slice(0,a).concat(o.slice(a+1)))}else e.$set(e.newCharacter,"immortal",i)}}}),e._v(" Immortal? ")]),o("label",[o("input",{directives:[{name:"model",rawName:"v-model",value:e.newCharacter.dead,expression:"newCharacter.dead"}],staticClass:"shadow border rounded py-2 px-2 m-1 text-gray-700 leading-tight focus:outline-none focus:ring-2 ring-gray-200",attrs:{type:"checkbox","true-value":!0,"false-value":!1},domProps:{checked:Array.isArray(e.newCharacter.dead)?e._i(e.newCharacter.dead,null)>-1:e.newCharacter.dead},on:{change:function(t){var o=e.newCharacter.dead,r=t.target,i=!!r.checked;if(Array.isArray(o)){var n=null,a=e._i(o,n);r.checked?a<0&&e.$set(e.newCharacter,"dead",o.concat([n])):a>-1&&e.$set(e.newCharacter,"dead",o.slice(0,a).concat(o.slice(a+1)))}else e.$set(e.newCharacter,"dead",i)}}}),e._v(" Dead? ")])]},proxy:!0}])}),o("FormComponent",{directives:[{name:"show",rawName:"v-show",value:e.showEditingControls,expression:"showEditingControls"}],ref:"editForm",staticClass:"my-2",attrs:{buttons:[{type:"default",event:"save",label:"Save"},{type:"default",event:"cancel",label:"Cancel"},{type:"default",event:"remove",label:"Remove"}]},on:{save:e.validatedUpdate,cancel:e.closeEditingControls,remove:e.validatedRemove}},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.editCharacter.name,expression:"editCharacter.name"}],staticClass:"shadow appearance-none border rounded w-full py-1 px-2 m-1 text-gray-700 leading-tight focus:outline-none focus:ring-2 ring-gray-200",attrs:{type:"text",placeholder:"Name"},domProps:{value:e.editCharacter.name},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.add.apply(null,arguments)},input:function(t){t.target.composing||e.$set(e.editCharacter,"name",t.target.value)}}}),o("textarea",{directives:[{name:"model",rawName:"v-model",value:e.editCharacter.bio,expression:"editCharacter.bio"}],staticClass:"shadow appearance-none border rounded w-full py-1 px-2 m-1 text-gray-700 leading-tight focus:outline-none focus:ring-2 ring-gray-200 resize-none",attrs:{placeholder:"Bio"},domProps:{value:e.editCharacter.bio},on:{input:function(t){t.target.composing||e.$set(e.editCharacter,"bio",t.target.value)}}}),e._v(" "),o("label",[o("input",{directives:[{name:"model",rawName:"v-model",value:e.editCharacter.immortal,expression:"editCharacter.immortal"}],staticClass:"shadow border rounded py-2 px-2 m-1 text-gray-700 leading-tight focus:outline-none focus:ring-2 ring-gray-200",attrs:{type:"checkbox","true-value":!0,"false-value":!1},domProps:{checked:Array.isArray(e.editCharacter.immortal)?e._i(e.editCharacter.immortal,null)>-1:e.editCharacter.immortal},on:{change:function(t){var o=e.editCharacter.immortal,r=t.target,i=!!r.checked;if(Array.isArray(o)){var n=null,a=e._i(o,n);r.checked?a<0&&e.$set(e.editCharacter,"immortal",o.concat([n])):a>-1&&e.$set(e.editCharacter,"immortal",o.slice(0,a).concat(o.slice(a+1)))}else e.$set(e.editCharacter,"immortal",i)}}}),e._v(" Immortal? ")]),o("label",[o("input",{directives:[{name:"model",rawName:"v-model",value:e.editCharacter.dead,expression:"editCharacter.dead"}],staticClass:"shadow border rounded py-2 px-2 m-1 text-gray-700 leading-tight focus:outline-none focus:ring-2 ring-gray-200",attrs:{type:"checkbox","true-value":!0,"false-value":!1},domProps:{checked:Array.isArray(e.editCharacter.dead)?e._i(e.editCharacter.dead,null)>-1:e.editCharacter.dead},on:{change:function(t){var o=e.editCharacter.dead,r=t.target,i=!!r.checked;if(Array.isArray(o)){var n=null,a=e._i(o,n);r.checked?a<0&&e.$set(e.editCharacter,"dead",o.concat([n])):a>-1&&e.$set(e.editCharacter,"dead",o.slice(0,a).concat(o.slice(a+1)))}else e.$set(e.editCharacter,"dead",i)}}}),e._v(" Dead? ")])]),o("transition-group",{staticClass:"my-2",attrs:{tag:"ul","enter-active-class":"transition-all duration-100 ease-out","leave-active-class":"transition-all duration-100 ease-in","enter-class":"opacity-0","enter-to-class":"opacity-100","leave-class":"opacity-100","leave-to-class":"opacity-0","move-class":"transition-transform duration-500 ease-in-out"}},e._l(e.characters,(function(t){return o("li",{key:"character-"+t.id},[o("CardComponent",{class:{"bg-red-50":t.immortal}},[o("div",{staticClass:"flex border-b mb-2"},[o("HeadingComponent",{staticClass:"select-none flex-1",attrs:{level:"6"}},[o("div",{class:{"line-through":t.dead,"cursor-pointer":!0},on:{click:function(o){return e.validatedToggle(t)}}},[e._v(" "+e._s(t.name)+" "),t.immortal?o("span",[e._v("(Immortal)")]):e._e()])]),o("div",{staticClass:"flex-initial text-right"},[o("span",{staticClass:"cursor-pointer mx-2 hover:text-gray-400",on:{click:function(o){return e.startEdit(t)}}},[e._v(" Edit ")])])],1),o("div",[e._v(e._s(t.bio))])])],1)})),0)],1)},pe=[],ge=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[e._t("default"),o("div",{staticClass:"my-1 flex flex-col md:flex-row"},e._l(e.buttons,(function(t){return o("ButtonComponent",{key:t.label+"-"+t.type,staticClass:"flex-1 my-2 md:my-0 md:mx-2",attrs:{type:t.type},on:{click:function(o){return e.$emit(t.event)}}},[e._v(" "+e._s(t.label)+" ")])})),1)],2)},he=[],ye={name:"FormComponent",props:{buttons:{type:Array,default:()=>[{type:"default",event:"save",label:"Save"},{type:"default",event:"cancel",label:"Cancel"}],validator:e=>e.every((e=>{if("object"!==typeof e)return!1;const t=Object.keys(e);return t.includes("type")&&t.includes("event")&&t.includes("label")}))}},components:{ButtonComponent:k}},ve=ye,fe=(0,m.Z)(ve,ge,he,!1,null,null,null),Ce=fe.exports,we=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[e.showControls?o("div",[o("FormComponent",{on:{save:function(t){return e.$emit("save")},cancel:function(t){return e.$emit("toggle",e.showControls)}}},[e._t("form")],2)],1):o("ButtonComponent",{staticClass:"w-full",attrs:{type:e.type},on:{click:function(t){return e.$emit("toggle",e.showControls)}}},[e._t("button")],2)],1)},ke=[],xe={name:"FormToggleComponent",props:{showControls:{type:Boolean,default:!1},type:{type:String,default:"default",validator:e=>["default","primary","secondary"].includes(e)}},components:{ButtonComponent:k,FormComponent:Ce}},_e=xe,be=(0,m.Z)(_e,we,ke,!1,null,null,null),Me=be.exports,Ae=o(8204);const Ee=(e,t="uuid")=>{const o=Re(e);return e.id||(o.id=(0,Ae.Z)(t)),o},Pe=e=>null===e?e:Array.isArray(e)?Array.from(e):"object"===typeof e?{...e}:e,Re=e=>{if(null===e)return e;try{return JSON.parse(JSON.stringify(e))}catch(t){return console.err(`Error with deep data copy, falling back to shallow copy.  Error: ${t}`),Pe(e)}},Se=(e,t,o="id")=>{let r={entity:null,idx:null};return e.some(((e,i)=>{if(e[o]===t)return r={entity:e,idx:i},!0})),r},De="character";var Ne=(e={})=>({name:"",dead:!1,immortal:!1,bio:"",...Ee(e,De)}),$e={name:"CharactersPane",data:function(){return{showAddingControls:!1,showEditingControls:!1,editCharacter:Ne(),newCharacter:Ne()}},components:{CardComponent:g,FormComponent:Ce,FormToggleComponent:Me,HeadingComponent:P},computed:{...(0,re.Se)("characters",["characters"])},methods:{...(0,re.OI)("notifications",{hideNotification:"hide"}),...(0,re.nv)("notifications",["showNotification"]),...(0,re.OI)("characters",["add","update","remove","toggle"]),validatedToggle(e){this.hideNotification(),this.editCharacter.id!==e.id?this.toggle(e):this.showNotification({message:"You cannot change this character whilst it is being edited.",type:"warning"})},validatedAdd(){""!==this.newCharacter.name&&""!==this.newCharacter.bio?(this.add(this.newCharacter),this.toggleAddingControls()):this.showNotification({message:"You must provide a name & bio.",type:"warning"})},validatedRemove(){let e;this.characters.some((t=>{if(t.id===this.editCharacter.id)return e=t,!0})),this.remove(e),this.closeEditingControls()},validatedUpdate(){""!==this.editCharacter.name&&""!==this.editCharacter.bio?(this.update(this.editCharacter),this.closeEditingControls()):this.showNotification({message:"You must provide a name & bio.",type:"warning"})},startEdit(e){this.editCharacter=Ne(e),this.showEditingControls=!0,this.$nextTick((()=>{const e=this.$refs.editForm.$el.getBoundingClientRect();window.scrollTo({top:e.y+window.scrollY,behavior:"smooth"})}))},toggleAddingControls(){this.hideNotification(),this.showAddingControls=!this.showAddingControls,this.newCharacter=Ne()},closeEditingControls(){this.hideNotification(),this.showEditingControls=!1,this.editCharacter=Ne()}}},Oe=$e,Te=(0,m.Z)(Oe,me,pe,!1,null,null,null),Fe=Te.exports,Ze=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("CardComponent",{attrs:{id:"prompts"}},[o("HeadingComponent",{attrs:{level:"2"}},[e._v("Prompts")]),o("FormToggleComponent",{attrs:{showControls:e.showControls},on:{save:e.validatedAddPrompt,toggle:e.toggleControls},scopedSlots:e._u([{key:"button",fn:function(){return[e._v(" Manually add Prompt? ")]},proxy:!0},{key:"form",fn:function(){return[o("div",{staticClass:"grid grid-rows md:grid-cols-2 gap-2"},[o("div",{staticClass:"grid grid grid-rows gap-2"},[o("label",{attrs:{for:"new-propt-number"}},[e._v(" Prompt Number: ")]),o("input",{directives:[{name:"model",rawName:"v-model",value:e.newPrompt.page,expression:"newPrompt.page"}],staticClass:"w-full shadow border rounded py-1 px-2 m-1 text-gray-700 leading-tight focus:outline-none focus:ring-2 ring-gray-200",attrs:{id:"new-prompt-number",type:"number",step:"1",min:e.firstUnusedPrompt},domProps:{value:e.newPrompt.page},on:{input:function(t){t.target.composing||e.$set(e.newPrompt,"page",t.target.value)}}})]),o("div",{staticClass:"grid grid grid-rows gap-2"},[o("label",{attrs:{for:"new-prompt-count"}},[e._v(" Times visited: ")]),o("select",{directives:[{name:"model",rawName:"v-model",value:e.newPrompt.count,expression:"newPrompt.count"}],staticClass:"w-full shadow border rounded py-1 px-2 m-1 text-gray-700 leading-tight focus:outline-none focus:ring-2 ring-gray-200",attrs:{id:"new-prompt-count"},on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.newPrompt,"count",t.target.multiple?o:o[0])}}},e._l([1,2,3],(function(t){return o("option",{key:"visits-"+t,domProps:{value:t}},[e._v(" "+e._s(t)+" ")])})),0)])]),o("label",[o("input",{directives:[{name:"model",rawName:"v-model",value:e.makeCurrent,expression:"makeCurrent"}],staticClass:"shadow border rounded py-2 px-2 m-1 text-gray-700 leading-tight focus:outline-none focus:ring-2 ring-gray-200",attrs:{type:"checkbox","true-value":!0,"false-value":!1},domProps:{checked:Array.isArray(e.makeCurrent)?e._i(e.makeCurrent,null)>-1:e.makeCurrent},on:{change:function(t){var o=e.makeCurrent,r=t.target,i=!!r.checked;if(Array.isArray(o)){var n=null,a=e._i(o,n);r.checked?a<0&&(e.makeCurrent=o.concat([n])):a>-1&&(e.makeCurrent=o.slice(0,a).concat(o.slice(a+1)))}else e.makeCurrent=i}}}),e._v(" Current? ")])]},proxy:!0}])}),e.currentPrompt.page?o("div",{staticClass:"divide-y divide-gray-200 divide-dashed"},[o("div",{staticClass:"text-red-700 my-2"},[o("strong",[e._v("Current:")]),e._v(" "+e._s(e.currentPrompt.page)+": "),o("span",{domProps:{innerHTML:e._s(e.tally(e.currentPrompt.count))}})]),o("ol",{staticClass:"my-2 max-h-40 overflow-auto"},e._l(e.prompts,(function(t){return o("li",{key:"prompt-key-"+t.id,staticClass:"select-none"},[o("div",{staticClass:"flex"},[o("div",{staticClass:"flex-initial w-6 text-center"},[o("span",{directives:[{name:"show",rawName:"v-show",value:t.page!==e.currentPrompt.page,expression:"prompt.page !== currentPrompt.page"}],staticClass:"cursor-pointer select-none hover:text-gray-400",attrs:{title:"Set as current prompt"},domProps:{innerHTML:e._s("&rarr;")},on:{click:function(o){return e.makePromptCurrent(t)}}})]),o("div",{staticClass:"flex-initial w-6 text-center"},[o("span",{directives:[{name:"show",rawName:"v-show",value:t.page!==e.currentPrompt.page,expression:"prompt.page !== currentPrompt.page"}],staticClass:"cursor-pointer select-none hover:text-gray-400",attrs:{title:"Remove prompt"},domProps:{innerHTML:e._s("&times;")},on:{click:function(o){return e.removePrompt(t)}}})]),o("div",{staticClass:"flex-initial w-6 text-center"},[o("span",{directives:[{name:"show",rawName:"v-show",value:t.count<3,expression:"prompt.count < 3"}],staticClass:"cursor-pointer select-none hover:text-gray-400",attrs:{title:"Increment visits"},domProps:{innerHTML:e._s("&plus;")},on:{click:function(o){return e.incrementPrompt(t)}}})]),o("div",{staticClass:"flex-initial w-6 text-center"},[o("span",{directives:[{name:"show",rawName:"v-show",value:t.count>1,expression:"prompt.count > 1"}],staticClass:"cursor-pointer select-none hover:text-gray-400",attrs:{title:"Decrement visits"},domProps:{innerHTML:e._s("&minus;")},on:{click:function(o){return e.decrementPrompt(t)}}})]),o("div",{staticClass:"flex-initial"},[o("span",{staticClass:"select-none",class:{"text-red-700":t.page===e.currentPrompt.page}},[o("span",{staticClass:"px-2"},[e._v(e._s(t.page)+":")]),o("span",{domProps:{innerHTML:e._s(e.tally(t.count))}})])])])])})),0)]):e._e()],1)},Ie=[];const Ue="prompt";var He=(e={})=>({page:1,count:0,...Ee(e,Ue)}),Be={name:"PromptsPane",data(){return{showControls:!1,newPrompt:He({page:1,count:1}),makeCurrent:!this.currentPrompt||!this.currentPrompt.page}},components:{CardComponent:g,FormToggleComponent:Me,HeadingComponent:P},computed:{...(0,re.rn)("actions",["currentPromptPage"]),...(0,re.Se)("actions",["prompts","currentPrompt"]),tally(){return e=>{let t="",o="&omicron;";e>=3&&(o="&oslash;");for(let r=0;r<e;r++)t+=o;return t}},firstUnusedPrompt(){var e=1;if(!this.prompts.length)return e;const t=[...this.prompts];return t.sort(((e,t)=>e.page>t.page?1:-1)),t.some((t=>{let o=t.page;return o>e||(e=o+1,!1)})),e}},methods:{...(0,re.OI)("actions",["addPrompt","incrementPrompt","decrementPrompt"]),...(0,re.nv)("actions",["makePromptCurrent","removePrompt"]),...(0,re.OI)("notifications",{hideNotification:"hide"}),...(0,re.nv)("notifications",["showNotification"]),validatedAddPrompt(){const e=this.prompts.some((e=>e.page===parseInt(this.newPrompt.page,10)));if(e)return void this.showNotification({message:"This prompt already exists, you cannot re-add it",type:"warning"});const t={...this.newPrompt};t.page=parseInt(t.page,10),this.addPrompt(t),this.makeCurrent&&this.makePromptCurrent(t),this.toggleControls()},toggleControls(){this.hideNotification(),this.showControls=!this.showControls,this.newPrompt=He({page:this.firstUnusedPrompt,count:1}),this.makeCurrent=!this.currentPrompt||!this.currentPrompt.page}}},Le=Be,Ye=(0,m.Z)(Le,Ze,Ie,!1,null,null,null),qe=Ye.exports,je=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("CardComponent",{attrs:{id:"marks"}},[o("HeadingComponent",{attrs:{level:"2"}},[e._v("Marks")]),o("FormToggleComponent",{attrs:{"show-controls":e.showAddingControls},on:{save:e.validatedAddMark,toggle:e.toggleAddingControls},scopedSlots:e._u([{key:"button",fn:function(){return[e._v(" Add a new Mark? ")]},proxy:!0},{key:"form",fn:function(){return[o("input",{directives:[{name:"model",rawName:"v-model",value:e.newMark.description,expression:"newMark.description"}],staticClass:"shadow appearance-none border rounded w-full py-1 px-2 m-1 text-gray-700 leading-tight focus:outline-none focus:ring-2 ring-gray-200",attrs:{type:"text",placeholder:"Description"},domProps:{value:e.newMark.description},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.validatedAddMark.apply(null,arguments)},input:function(t){t.target.composing||e.$set(e.newMark,"description",t.target.value)}}})]},proxy:!0}])}),o("FormComponent",{directives:[{name:"show",rawName:"v-show",value:e.showEditingControls,expression:"showEditingControls"}],staticClass:"my-2",attrs:{buttons:[{type:"default",event:"save",label:"Save"},{type:"default",event:"cancel",label:"Cancel"},{type:"default",event:"remove",label:"Remove"}]},on:{save:e.validatedUpdateMark,cancel:e.closeEditingControls,remove:e.validatedRemoveMark}},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.editMark.description,expression:"editMark.description"}],staticClass:"shadow appearance-none border rounded w-full py-1 px-2 m-1 text-gray-700 leading-tight focus:outline-none focus:ring-2 ring-gray-200",attrs:{type:"text",placeholder:"Description"},domProps:{value:e.editMark.description},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.validatedUpdateMark.apply(null,arguments)},input:function(t){t.target.composing||e.$set(e.editMark,"description",t.target.value)}}})]),o("transition-group",{staticClass:"my-2",attrs:{tag:"ul","enter-active-class":"transition-all duration-100 ease-out","leave-active-class":"transition-all duration-100 ease-in","enter-class":"opacity-0","enter-to-class":"opacity-100","leave-class":"opacity-100","leave-to-class":"opacity-0","move-class":"transition-transform duration-500 ease-in-out"}},e._l(e.marks,(function(t){return o("li",{key:"mark-"+t.id,staticClass:"my-2"},[o("div",{staticClass:"grid grid-cols-6"},[o("span",{staticClass:"col-span-5"},[e._v(e._s(t.description))]),o("span",{staticClass:"cursor-pointer select-none flex-initial text-right mx-2 hover:text-gray-400",on:{click:function(o){return e.startEdit(t)}}},[e._v(" Edit ")])])])})),0)],1)},Je=[];const ze="mark";var Ge=(e={})=>({description:"",...Ee(e,ze)}),Qe={name:"MarksPane",data:function(){return{newMark:Ge(),editMark:Ge(),showAddingControls:!1,showEditingControls:!1}},components:{CardComponent:g,FormComponent:Ce,FormToggleComponent:Me,HeadingComponent:P},computed:{...(0,re.rn)("marks",["marks"])},methods:{...(0,re.OI)("notifications",{hideNotification:"hide"}),...(0,re.nv)("notifications",["showNotification"]),...(0,re.OI)("marks",["add","update","remove"]),validatedAddMark(){""!==this.newMark.description?(this.add(this.newMark),this.toggleAddingControls()):this.showNotification({message:"You must provide a description",type:"warning"})},validatedRemoveMark(){let e;this.marks.some((t=>{if(t.id===this.editMark.id)return e=t,!0})),this.remove(e),this.closeEditingControls()},validatedUpdateMark(){""!==this.editMark.description?(this.update(this.editMark),this.closeEditingControls()):this.showNotification({message:"You must provide a description",type:"warning"})},startEdit(e){this.editMark=Ge(e),this.showEditingControls=!0},closeEditingControls(){this.hideNotification(),this.showEditingControls=!1,this.editMark=Ge()},toggleAddingControls(){this.hideNotification(),this.showAddingControls=!this.showAddingControls,this.newMark=Ge()}}},Ve=Qe,Ke=(0,m.Z)(Ve,je,Je,!1,null,null,null),We=Ke.exports,Xe=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("CardComponent",{attrs:{id:"memories"}},[o("HeadingComponent",{attrs:{level:"2"}},[e._v("Memories")]),e.canAddMemories?o("FormToggleComponent",{attrs:{type:"primary","show-controls":e.showAddingControls},on:{save:e.validatedAddMemory,toggle:e.toggleAddingControls},scopedSlots:e._u([{key:"button",fn:function(){return[e._v(" Add a new Memory? ")]},proxy:!0},{key:"form",fn:function(){return[o("input",{directives:[{name:"model",rawName:"v-model",value:e.newMemory.description,expression:"newMemory.description"}],staticClass:"shadow appearance-none border rounded w-full py-1 px-2 m-1 text-gray-700 leading-tight focus:outline-none focus:ring-2 ring-gray-200",attrs:{type:"text",placeholder:"Description"},domProps:{value:e.newMemory.description},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.validatedAddMemory.apply(null,arguments)},input:function(t){t.target.composing||e.$set(e.newMemory,"description",t.target.value)}}}),o("label",[o("input",{directives:[{name:"model",rawName:"v-model",value:e.newMemory.forgotten,expression:"newMemory.forgotten"}],staticClass:"shadow border rounded py-2 px-2 m-1 text-gray-700 leading-tight focus:outline-none focus:ring-2 ring-gray-200",attrs:{type:"checkbox","true-value":!0,"false-value":!1},domProps:{checked:Array.isArray(e.newMemory.forgotten)?e._i(e.newMemory.forgotten,null)>-1:e.newMemory.forgotten},on:{change:function(t){var o=e.newMemory.forgotten,r=t.target,i=!!r.checked;if(Array.isArray(o)){var n=null,a=e._i(o,n);r.checked?a<0&&e.$set(e.newMemory,"forgotten",o.concat([n])):a>-1&&e.$set(e.newMemory,"forgotten",o.slice(0,a).concat(o.slice(a+1)))}else e.$set(e.newMemory,"forgotten",i)}}}),e._v(" Forgotten? ")]),e.hasDiary&&!e.isDiaryFull?o("label",[o("input",{directives:[{name:"model",rawName:"v-model",value:e.newMemory.diary,expression:"newMemory.diary"}],staticClass:"shadow border rounded py-2 px-2 m-1 text-gray-700 leading-tight focus:outline-none focus:ring-2 ring-gray-200",attrs:{type:"checkbox","true-value":e.diary.id,"false-value":""},domProps:{checked:Array.isArray(e.newMemory.diary)?e._i(e.newMemory.diary,null)>-1:e._q(e.newMemory.diary,e.diary.id)},on:{change:function(t){var o=e.newMemory.diary,r=t.target,i=r.checked?e.diary.id:"";if(Array.isArray(o)){var n=null,a=e._i(o,n);r.checked?a<0&&e.$set(e.newMemory,"diary",o.concat([n])):a>-1&&e.$set(e.newMemory,"diary",o.slice(0,a).concat(o.slice(a+1)))}else e.$set(e.newMemory,"diary",i)}}}),e._v(" Diarised? ")]):e._e()]},proxy:!0}],null,!1,2362237444)}):o("div",[e._v(" You must choose to forget a memory to add more. ")]),o("FormComponent",{directives:[{name:"show",rawName:"v-show",value:e.showEditingControls,expression:"showEditingControls"}],ref:"editForm",staticClass:"my-2",attrs:{buttons:[{type:"default",event:"save",label:"Save"},{type:"default",event:"cancel",label:"Cancel"},{type:"default",event:"remove",label:"Remove"}]},on:{save:e.validatedUpdateMemory,cancel:e.closeEditingControls,remove:e.validatedRemoveMemory}},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.editMemory.description,expression:"editMemory.description"}],staticClass:"shadow appearance-none border rounded w-full py-1 px-2 m-1 text-gray-700 leading-tight focus:outline-none focus:ring-2 ring-gray-200",attrs:{type:"text",placeholder:"Description"},domProps:{value:e.editMemory.description},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.validatedUpdateMemory.apply(null,arguments)},input:function(t){t.target.composing||e.$set(e.editMemory,"description",t.target.value)}}}),o("label",[o("input",{directives:[{name:"model",rawName:"v-model",value:e.editMemory.forgotten,expression:"editMemory.forgotten"}],staticClass:"shadow border rounded py-2 px-2 m-1 text-gray-700 leading-tight focus:outline-none focus:ring-2 ring-gray-200",attrs:{type:"checkbox","true-value":!0,"false-value":!1},domProps:{checked:Array.isArray(e.editMemory.forgotten)?e._i(e.editMemory.forgotten,null)>-1:e.editMemory.forgotten},on:{change:function(t){var o=e.editMemory.forgotten,r=t.target,i=!!r.checked;if(Array.isArray(o)){var n=null,a=e._i(o,n);r.checked?a<0&&e.$set(e.editMemory,"forgotten",o.concat([n])):a>-1&&e.$set(e.editMemory,"forgotten",o.slice(0,a).concat(o.slice(a+1)))}else e.$set(e.editMemory,"forgotten",i)}}}),e._v(" Forgotten? ")]),e.hasDiary&&!e.isDiaryFull||""!==e.editMemory.diary?o("label",[o("input",{directives:[{name:"model",rawName:"v-model",value:e.editMemory.diary,expression:"editMemory.diary"}],staticClass:"shadow border rounded py-2 px-2 m-1 text-gray-700 leading-tight focus:outline-none focus:ring-2 ring-gray-200",attrs:{type:"checkbox","true-value":e.diary.id,"false-value":""},domProps:{checked:Array.isArray(e.editMemory.diary)?e._i(e.editMemory.diary,null)>-1:e._q(e.editMemory.diary,e.diary.id)},on:{change:function(t){var o=e.editMemory.diary,r=t.target,i=r.checked?e.diary.id:"";if(Array.isArray(o)){var n=null,a=e._i(o,n);r.checked?a<0&&e.$set(e.editMemory,"diary",o.concat([n])):a>-1&&e.$set(e.editMemory,"diary",o.slice(0,a).concat(o.slice(a+1)))}else e.$set(e.editMemory,"diary",i)}}}),e._v(" Diarised? ")]):e._e(),e.hasEvents(e.editMemory)?o("div",{staticClass:"mt-2"},[o("HeadingComponent",{attrs:{level:"6"}},[e._v(" Events ")]),e._l(e.editEvents,(function(t){return o("div",{key:"edit-event-"+t.id},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.description,expression:"event.description"}],staticClass:"shadow appearance-none border rounded w-full py-1 px-2 m-1 text-gray-700 leading-tight focus:outline-none focus:ring-2 ring-gray-200",attrs:{type:"text",placeholder:"Description"},domProps:{value:t.description},on:{input:function(o){o.target.composing||e.$set(t,"description",o.target.value)}}})])}))],2):e._e()]),o("transition-group",{attrs:{"enter-active-class":"transition-all duration-400 ease-out","leave-active-class":"transition-all duration-400 ease-in","enter-class":"opacity-0 scale-40","enter-to-class":"opacity-100 scale-100","leave-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-40"}},e._l(e.activeMemories,(function(t){return o("MemoryComponent",{key:"memory-"+t.id,attrs:{memory:t,"can-add-memories":e.canAddMemories,"can-add-events":t.id!==e.editMemory.id&&e.events(t).length<3,"can-diarise":e.hasDiary&&t.id!==e.editMemory.id,"can-toggle":t.id!==e.editMemory.id},on:{"add-event":e.addEvent,"remove-event":e.validatedRemoveEvent,"edit-memory":e.startEdit,"toggle-memory":e.toggleMemory,"diarise-memory":e.diariseMemory,"undiarise-memory":e.undiariseMemory}})})),1),e.hasDiary?o("SlideDownPanelComponent",{scopedSlots:e._u([{key:"closed-heading",fn:function(){return[e._v(" Diary ")]},proxy:!0}],null,!1,257998573)},[e.diaryMemories.length>0?o("div",[o("transition-group",{attrs:{"enter-active-class":"transition-all duration-400 ease-out","leave-active-class":"transition-all duration-400 ease-in","enter-class":"opacity-0 scale-40","enter-to-class":"opacity-100 scale-100","leave-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-40"}},e._l(e.diaryMemories,(function(t){return o("MemoryComponent",{key:"diary-"+t.id,attrs:{memory:t,"can-add-memories":e.canAddMemories,"can-add-events":!1,"can-diarise":e.hasDiary,"can-toggle":t.id!==e.editMemory.id},on:{"add-event":e.addEvent,"remove-event":e.validatedRemoveEvent,"edit-memory":e.startEdit,"toggle-memory":e.toggleMemory,"diarise-memory":e.diariseMemory,"undiarise-memory":e.undiariseMemory}})})),1)],1):o("div",{staticClass:"py-2"},[e._v(" The diary is empty. ")])]):e._e(),o("SlideDownPanelComponent",{scopedSlots:e._u([{key:"closed-heading",fn:function(){return[e._v(" Forgotten Memories ")]},proxy:!0}])},[e.forgottenMemories.length>0?o("div",[o("transition-group",{attrs:{"enter-active-class":"transition-all duration-400 ease-out","leave-active-class":"transition-all duration-400 ease-in","enter-class":"opacity-0 scale-40","enter-to-class":"opacity-100 scale-100","leave-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-40"}},e._l(e.forgottenMemories,(function(t){return o("MemoryComponent",{key:"memory-"+t.id,attrs:{memory:t,"can-add-memories":e.canAddMemories,"can-add-events":!1,"can-diarise":!1,"can-toggle":t.id!==e.editMemory.id},on:{"add-event":e.addEvent,"remove-event":e.validatedRemoveEvent,"edit-memory":e.startEdit,"toggle-memory":e.toggleMemory,"diarise-memory":e.diariseMemory,"undiarise-memory":e.undiariseMemory}})})),1)],1):o("div",{staticClass:"py-2"},[e._v(" You have forgotten no memories... yet. ")])])],1)},et=[],tt=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("CardComponent",[o("div",{staticClass:"flex border-b mb-2"},[o("HeadingComponent",{class:{"flex-1":!0,"line-through":e.memory.forgotten},attrs:{level:"6"}},[e._v(" "+e._s(e.memory.description)+" ")]),o("div",{staticClass:"flex-initial text-right"},[o("span",{staticClass:"cursor-pointer mx-2 hover:text-gray-400",on:{click:function(t){return e.$emit("edit-memory",e.memory)}}},[e._v(" Edit ")])])],1),o("ul",{staticClass:"my-3"},e._l(e.events(e.memory),(function(t){return o("li",{key:"event-"+t.id},[o("CardComponent",[o("div",{staticClass:"flex"},[o("span",{class:{"flex-1":!0,"line-through":e.memory.forgotten,"text-gray-400":e.memory.forgotten}},[e._v(e._s(t.description))]),o("div",{staticClass:"text-right flex-inital"},[o("RemoveCrossComponent",{on:{remove:function(o){return e.$emit("remove-event",t)}}})],1)])])],1)})),0),e.canAddEvents?o("FormToggleComponent",{attrs:{showControls:e.showControls},on:{save:e.add,toggle:e.toggleControls},scopedSlots:e._u([{key:"button",fn:function(){return[e._v(" Add an Event? ")]},proxy:!0},{key:"form",fn:function(){return[o("input",{directives:[{name:"model",rawName:"v-model",value:e.newEvent.description,expression:"newEvent.description"}],staticClass:"shadow appearance-none border rounded w-full py-1 px-2 m-1 text-gray-700 leading-tight focus:outline-none focus:ring-2 ring-gray-200",attrs:{type:"text",placeholder:"Description"},domProps:{value:e.newEvent.description},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.add.apply(null,arguments)},input:function(t){t.target.composing||e.$set(e.newEvent,"description",t.target.value)}}})]},proxy:!0}],null,!1,667397553)}):e._e(),o("div",{directives:[{name:"show",rawName:"v-show",value:e.canToggle&&(!e.memory.forgotten||e.memory.forgotten&&""!==e.memory.diary||e.canAddMemories),expression:"canToggle && ((!memory.forgotten || memory.forgotten && memory.diary !== '') || canAddMemories)"}],staticClass:"my-2 grid grid-rows gap-2"},[o("ButtonComponent",{staticClass:"w-full",on:{click:function(t){return e.$emit("toggle-memory",e.memory)}}},[e.memory.forgotten?o("span",[e._v(" Recover Memory ")]):""===e.memory.diary?o("span",[e._v(" Forget Memory ")]):o("span",[e._v(" Scratch Out Memory ")])]),e.canDiarise?[""!==e.memory.diary||e.isDiaryFull?""!==e.memory.diary&&e.canAddMemories?o("ButtonComponent",{staticClass:"w-full",on:{click:function(t){return e.$emit("undiarise-memory",e.memory)}}},[e._v(" Recover from Diary ")]):e._e():o("ButtonComponent",{staticClass:"w-full",on:{click:function(t){return e.$emit("diarise-memory",e.memory)}}},[e._v(" Send to Diary ")])]:e._e()],2)],1)},ot=[],rt=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("span",{staticClass:"cursor-pointer select-none mx-1 hover:text-gray-400",attrs:{title:"Remove item"},domProps:{innerHTML:e._s("&times;")},on:{click:function(t){return e.$emit("remove")}}})},it=[],nt={name:"RemoveCrossComponent"},at=nt,st=(0,m.Z)(at,rt,it,!1,null,null,null),lt=st.exports;const dt="memory",ct="event",ut=(e={})=>({description:"",forgotten:!1,diary:"",...Ee(e,dt)}),mt=(e={})=>({description:"",memory:"",...Ee(e,ct)});var pt={name:"MemoryComponent",props:{memory:{type:Object,required:!0,validator:e=>"string"===typeof e.diary&&"boolean"===typeof e.forgotten},canAddMemories:{type:Boolean,required:!0},canAddEvents:{type:Boolean,required:!0},canDiarise:{type:Boolean,required:!0},canToggle:{type:Boolean,required:!0}},data:function(){return{showControls:!1,newEvent:mt({memory:this.memory.id})}},components:{ButtonComponent:k,CardComponent:g,FormToggleComponent:Me,HeadingComponent:P,RemoveCrossComponent:lt},computed:{...(0,re.Se)("resources",["hasDiary","isDiaryFull"]),...(0,re.Se)("memories",["events"])},methods:{...(0,re.OI)("notifications",{hideNotification:"hide"}),...(0,re.nv)("notifications",["showNotification"]),add(){if(""===this.newEvent.description)return void this.showNotification({message:"You must provide a description",type:"warning"});const e=mt(this.newEvent);this.$emit("add-event",e),this.toggleControls()},toggleControls(){this.hideNotification(),this.showControls=!this.showControls,this.newEvent=mt({memory:this.memory.id})}}},gt=pt,ht=(0,m.Z)(gt,tt,ot,!1,null,null,null),yt=ht.exports,vt={name:"MemoriesPane",data(){return{showAddingControls:!1,showEditingControls:!1,editMemory:ut(),editEvents:[],newMemory:ut()}},components:{CardComponent:g,FormComponent:Ce,FormToggleComponent:Me,HeadingComponent:P,MemoryComponent:yt,SlideDownPanelComponent:F},computed:{...(0,re.rn)("memories",["memories"]),...(0,re.Se)("memories",["canAddMemories","forgottenMemories","activeMemories","events","hasEvents"]),...(0,re.Se)("resources",{diary:"diary",hasDiary:"hasDiary",isDiaryFull:"isDiaryFull",diaryMemories:"memories"})},methods:{...(0,re.OI)("notifications",{hideNotification:"hide"}),...(0,re.nv)("notifications",["showNotification"]),...(0,re.OI)("memories",["addMemory","updateMemory","removeMemory","toggleMemory","addEvent","removeEvent","diarise","undiarise","updateEvent"]),validatedAddMemory(){if(this.hideNotification,""===this.newMemory.description)return void this.showNotification({message:"You must provide a description.",type:"warning"});const e=ut(this.newMemory);this.addMemory(e),this.toggleAddingControls()},validatedRemoveMemory(){this.hasEvents(this.editMemory)&&this.events(this.editMemory).forEach((e=>{this.removeEvent(e)})),this.removeMemory(this.editMemory),this.closeEditingControls()},validatedRemoveEvent(e){e.memory!==this.editMemory.id?this.removeEvent(e):this.showNotification({message:"You cannot alter this memory whilst it is being edited.",type:"warning"})},validatedUpdateMemory(){this.updateMemory(this.editMemory),this.hasEvents(this.editMemory)&&this.editEvents.forEach((e=>this.updateEvent(e))),this.closeEditingControls()},diariseMemory(e){this.diarise({diary:this.diary,memory:e})},undiariseMemory(e){this.undiarise(e)},startEdit(e){this.editMemory=ut(e),this.editEvents=this.events(this.editMemory).map((e=>mt(e))),this.showEditingControls=!0,this.$nextTick((()=>{const e=this.$refs.editForm.$el.getBoundingClientRect();window.scrollTo({top:e.y+window.scrollY,behavior:"smooth"})}))},toggleAddingControls(){this.newMemory=ut(),this.showAddingControls=!this.showAddingControls},closeEditingControls(){this.hideNotification(),this.showEditingControls=!1,this.editMemory=ut(),this.editEvents=[]}}},ft=vt,Ct=(0,m.Z)(ft,Xe,et,!1,null,null,null),wt=Ct.exports,kt=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("transition",{attrs:{"enter-active-class":"transition-all duration-400 ease-out","leave-active-class":"transition-all duration-400 ease-in","enter-class":"opacity-0 scale-40","enter-to-class":"opacity-100 scale-100","leave-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-40"}},[o("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],class:e.classes},[o("div",{staticClass:"flex-1"},[e._v(" "+e._s(e.message)+" ")]),o("RemoveCrossComponent",{staticClass:"flex-initial",on:{remove:e.hide}})],1)])},xt=[];const _t={default:{"border-indigo-400":!0,"bg-indigo-100":!0,"text-indigo-600":!0},danger:{"border-red-600":!0,"bg-red-200":!0,"text-red-800":!0},warning:{"border-yellow-400":!0,"bg-yellow-100":!0,"text-yellow-600":!0}};var bt=null,Mt={name:"NotificationPane",components:{RemoveCrossComponent:lt},computed:{...(0,re.rn)("notifications",["visible","message","type"]),classes(){return{sticky:!0,"inset-6":!0,border:!0,rounded:!0,"p-2":!0,flex:!0,..._t[this.type]}}},methods:{...(0,re.OI)("notifications",["hide"])},watch:{visible(e){clearTimeout(bt),e&&(bt=setTimeout((()=>{this.hide()}),5e3))}}},At=Mt,Et=(0,m.Z)(At,kt,xt,!1,null,null,null),Pt=Et.exports,Rt=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("CardComponent",{staticClass:"m-1 p-4 border-2 border-gray-100",attrs:{id:"resources"}},[o("HeadingComponent",{attrs:{level:"2"}},[e._v("Resources")]),o("FormToggleComponent",{staticClass:"my-2",attrs:{"show-controls":e.showAddingResourceControls},on:{save:e.validatedAddResource,toggle:e.toggleAddingResourceControls},scopedSlots:e._u([{key:"button",fn:function(){return[e._v(" Add a new Resource? ")]},proxy:!0},{key:"form",fn:function(){return[o("input",{directives:[{name:"model",rawName:"v-model",value:e.newResource.name,expression:"newResource.name"}],staticClass:"shadow appearance-none border rounded w-full py-1 px-2 m-1 text-gray-700 leading-tight focus:outline-none focus:ring-2 ring-gray-200",attrs:{type:"text",placeholder:"Description"},domProps:{value:e.newResource.name},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.validatedAddResource.apply(null,arguments)},input:function(t){t.target.composing||e.$set(e.newResource,"name",t.target.value)}}}),o("label",[o("input",{directives:[{name:"model",rawName:"v-model",value:e.newResource.lost,expression:"newResource.lost"}],staticClass:"shadow border rounded py-2 px-2 m-1 text-gray-700 leading-tight focus:outline-none focus:ring-2 ring-gray-200",attrs:{type:"checkbox","true-value":!0,"false-value":!1},domProps:{checked:Array.isArray(e.newResource.lost)?e._i(e.newResource.lost,null)>-1:e.newResource.lost},on:{change:function(t){var o=e.newResource.lost,r=t.target,i=!!r.checked;if(Array.isArray(o)){var n=null,a=e._i(o,n);r.checked?a<0&&e.$set(e.newResource,"lost",o.concat([n])):a>-1&&e.$set(e.newResource,"lost",o.slice(0,a).concat(o.slice(a+1)))}else e.$set(e.newResource,"lost",i)}}}),e._v(" Lost? ")]),o("label",[o("input",{directives:[{name:"model",rawName:"v-model",value:e.newResource.stationary,expression:"newResource.stationary"}],staticClass:"shadow border rounded py-2 px-2 m-1 text-gray-700 leading-tight focus:outline-none focus:ring-2 ring-gray-200",attrs:{type:"checkbox","true-value":!0,"false-value":!1},domProps:{checked:Array.isArray(e.newResource.stationary)?e._i(e.newResource.stationary,null)>-1:e.newResource.stationary},on:{change:function(t){var o=e.newResource.stationary,r=t.target,i=!!r.checked;if(Array.isArray(o)){var n=null,a=e._i(o,n);r.checked?a<0&&e.$set(e.newResource,"stationary",o.concat([n])):a>-1&&e.$set(e.newResource,"stationary",o.slice(0,a).concat(o.slice(a+1)))}else e.$set(e.newResource,"stationary",i)}}}),e._v(" Stationary? ")])]},proxy:!0}])}),e.hasDiary?e._e():o("FormToggleComponent",{attrs:{"show-controls":e.showAddingDiaryControls},on:{save:e.validatedAddDiary,toggle:e.toggleAddingDiaryControls},scopedSlots:e._u([{key:"button",fn:function(){return[e._v(" Add a Diary? ")]},proxy:!0},{key:"form",fn:function(){return[o("input",{directives:[{name:"model",rawName:"v-model",value:e.newDiary.name,expression:"newDiary.name"}],staticClass:"shadow appearance-none border rounded w-full py-1 px-2 m-1 text-gray-700 leading-tight focus:outline-none focus:ring-2 ring-gray-200",attrs:{type:"text",placeholder:"Name"},domProps:{value:e.newDiary.name},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.addDiary.apply(null,arguments)},input:function(t){t.target.composing||e.$set(e.newDiary,"name",t.target.value)}}}),o("label",[o("input",{directives:[{name:"model",rawName:"v-model",value:e.newDiary.lost,expression:"newDiary.lost"}],staticClass:"shadow border rounded py-2 px-2 m-1 text-gray-700 leading-tight focus:outline-none focus:ring-2 ring-gray-200",attrs:{type:"checkbox","true-value":!0,"false-value":!1},domProps:{checked:Array.isArray(e.newDiary.lost)?e._i(e.newDiary.lost,null)>-1:e.newDiary.lost},on:{change:function(t){var o=e.newDiary.lost,r=t.target,i=!!r.checked;if(Array.isArray(o)){var n=null,a=e._i(o,n);r.checked?a<0&&e.$set(e.newDiary,"lost",o.concat([n])):a>-1&&e.$set(e.newDiary,"lost",o.slice(0,a).concat(o.slice(a+1)))}else e.$set(e.newDiary,"lost",i)}}}),e._v(" Lost? ")])]},proxy:!0}],null,!1,4200738096)}),o("FormComponent",{directives:[{name:"show",rawName:"v-show",value:e.showEditingResourceControls,expression:"showEditingResourceControls"}],staticClass:"my-2",attrs:{buttons:[{type:"default",event:"save",label:"Save"},{type:"default",event:"cancel",label:"Cancel"},{type:"default",event:"remove",label:"Remove"}]},on:{save:e.validatedUpdateResource,cancel:e.closeEditingResourceControls,remove:e.validatedRemoveResource}},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.editResource.name,expression:"editResource.name"}],staticClass:"shadow appearance-none border rounded w-full py-1 px-2 m-1 text-gray-700 leading-tight focus:outline-none focus:ring-2 ring-gray-200",attrs:{type:"text",placeholder:"Description"},domProps:{value:e.editResource.name},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.validatedAddResource.apply(null,arguments)},input:function(t){t.target.composing||e.$set(e.editResource,"name",t.target.value)}}}),o("label",[o("input",{directives:[{name:"model",rawName:"v-model",value:e.editResource.lost,expression:"editResource.lost"}],staticClass:"shadow border rounded py-2 px-2 m-1 text-gray-700 leading-tight focus:outline-none focus:ring-2 ring-gray-200",attrs:{type:"checkbox","true-value":!0,"false-value":!1},domProps:{checked:Array.isArray(e.editResource.lost)?e._i(e.editResource.lost,null)>-1:e.editResource.lost},on:{change:function(t){var o=e.editResource.lost,r=t.target,i=!!r.checked;if(Array.isArray(o)){var n=null,a=e._i(o,n);r.checked?a<0&&e.$set(e.editResource,"lost",o.concat([n])):a>-1&&e.$set(e.editResource,"lost",o.slice(0,a).concat(o.slice(a+1)))}else e.$set(e.editResource,"lost",i)}}}),e._v(" Lost? ")]),o("label",[o("input",{directives:[{name:"model",rawName:"v-model",value:e.editResource.stationary,expression:"editResource.stationary"}],staticClass:"shadow border rounded py-2 px-2 m-1 text-gray-700 leading-tight focus:outline-none focus:ring-2 ring-gray-200",attrs:{type:"checkbox","true-value":!0,"false-value":!1},domProps:{checked:Array.isArray(e.editResource.stationary)?e._i(e.editResource.stationary,null)>-1:e.editResource.stationary},on:{change:function(t){var o=e.editResource.stationary,r=t.target,i=!!r.checked;if(Array.isArray(o)){var n=null,a=e._i(o,n);r.checked?a<0&&e.$set(e.editResource,"stationary",o.concat([n])):a>-1&&e.$set(e.editResource,"stationary",o.slice(0,a).concat(o.slice(a+1)))}else e.$set(e.editResource,"stationary",i)}}}),e._v(" Stationary? ")])]),o("FormComponent",{directives:[{name:"show",rawName:"v-show",value:e.showEditingDiaryControls,expression:"showEditingDiaryControls"}],staticClass:"my-2",attrs:{buttons:[{type:"default",event:"save",label:"Save"},{type:"default",event:"cancel",label:"Cancel"},{type:"default",event:"remove",label:"Remove"}]},on:{save:e.validatedUpdateDiary,cancel:e.closeEditingDiaryControls,remove:e.validatedRemoveDiary}},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.editDiary.name,expression:"editDiary.name"}],staticClass:"shadow appearance-none border rounded w-full py-1 px-2 m-1 text-gray-700 leading-tight focus:outline-none focus:ring-2 ring-gray-200",attrs:{type:"text",placeholder:"Description"},domProps:{value:e.editDiary.name},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.validatedAddResource.apply(null,arguments)},input:function(t){t.target.composing||e.$set(e.editDiary,"name",t.target.value)}}}),o("label",[o("input",{directives:[{name:"model",rawName:"v-model",value:e.editDiary.lost,expression:"editDiary.lost"}],staticClass:"shadow border rounded py-2 px-2 m-1 text-gray-700 leading-tight focus:outline-none focus:ring-2 ring-gray-200",attrs:{type:"checkbox","true-value":!0,"false-value":!1},domProps:{checked:Array.isArray(e.editDiary.lost)?e._i(e.editDiary.lost,null)>-1:e.editDiary.lost},on:{change:function(t){var o=e.editDiary.lost,r=t.target,i=!!r.checked;if(Array.isArray(o)){var n=null,a=e._i(o,n);r.checked?a<0&&e.$set(e.editDiary,"lost",o.concat([n])):a>-1&&e.$set(e.editDiary,"lost",o.slice(0,a).concat(o.slice(a+1)))}else e.$set(e.editDiary,"lost",i)}}}),e._v(" Lost? ")])]),o("transition-group",{staticClass:"my-2 pb-2",attrs:{tag:"ul","enter-active-class":"transition-all duration-100 ease-out","leave-active-class":"transition-all duration-100 ease-in","enter-class":"opacity-0","enter-to-class":"opacity-100","leave-class":"opacity-100","leave-to-class":"opacity-0","move-class":"transition-transform duration-500 ease-in-out"}},e._l(e.resources,(function(t){return o("li",{key:"resource-"+t.id,staticClass:"select-none"},[o("div",{staticClass:"grid grid-cols-6"},[o("span",{staticClass:"col-span-5"},[o("span",{staticClass:"cursor-pointer hover:text-gray-400",on:{click:function(o){return e.validatedToggleResource(t)}}},[o("span",{class:{"line-through":t.lost}},[e._v(e._s(t.name))]),t.stationary?o("span",[e._v(" (stationary)")]):e._e()])]),o("span",{staticClass:"cursor-pointer select-none flex-initial text-right mx-2 hover:text-gray-400",on:{click:function(o){return e.startEditResource(t)}}},[e._v(" Edit ")])])])})),0),o("transition-group",{directives:[{name:"show",rawName:"v-show",value:e.diaries.length>0,expression:"diaries.length > 0"}],staticClass:"my-2 border-t pt-2",attrs:{tag:"ul","enter-active-class":"transition-all duration-100 ease-out","leave-active-class":"transition-all duration-100 ease-in","enter-class":"opacity-0","enter-to-class":"opacity-100","leave-class":"opacity-100","leave-to-class":"opacity-0","move-class":"transition-transform duration-500 ease-in-out"}},e._l(e.diaries,(function(t){return o("li",{key:"diary-"+t.id,staticClass:"select-none"},[o("div",{staticClass:"grid grid-cols-6"},[o("span",{staticClass:"col-span-5"},[o("span",{staticClass:"cursor-pointer hover:text-gray-400",on:{click:function(o){return e.validatedToggleDiary(t)}}},[o("span",{class:{"line-through":t.lost}},[e._v(e._s(t.name))]),o("span",{staticClass:"italic"},[e._v(" (diary - "+e._s(e.activeMemories.length)+" of 4 memories)")])])]),o("span",{staticClass:"cursor-pointer select-none flex-initial text-right mx-2 hover:text-gray-400",on:{click:function(o){return e.startEditDiary(t)}}},[e._v(" Edit ")])])])})),0)],1)},St=[];const Dt="resource",Nt="diary",$t=(e={})=>({name:"",lost:!1,stationary:!1,...Ee(e,Dt)}),Ot=(e={})=>({name:"",lost:!1,...Ee(e,Nt)});var Tt={name:"ResourcesPane",data:function(){return{showAddingResourceControls:!1,showAddingDiaryControls:!1,showEditingResourceControls:!1,showEditingDiaryControls:!1,newResource:$t(),newDiary:Ot(),editResource:$t(),editDiary:Ot()}},components:{CardComponent:g,FormComponent:Ce,FormToggleComponent:Me,HeadingComponent:P},computed:{...(0,re.Se)("resources",["hasDiary","diaries","resources","diary","activeMemories"])},methods:{...(0,re.OI)("notifications",{hideNotification:"hide"}),...(0,re.nv)("notifications",["showNotification"]),...(0,re.OI)("resources",["addResource","updateResource","removeResource","toggleResource","addDiary","updateDiary","removeDiary","toggleDiary"]),validatedAddResource(){""!==this.newResource.name?(this.addResource(this.newResource),this.toggleAddingResourceControls()):this.showNotification({message:"You must provide a description.",type:"warning"})},validatedToggleResource(e){this.hideNotification(),this.editResource.id!==e.id?this.toggleResource(e):this.showNotification({message:"You cannot change this resource whilst it is being edited.",type:"warning"})},validatedToggleDiary(e){if(this.hideNotification(),this.editDiary.id!==e.id){if(this.hasDiary){if(e.lost)return void this.showNotification({message:"You may only have one active diary.",type:"warning"});if(this.memories.length>0)return void this.showNotification({message:"Please cross out existing memories before losing the diary.",type:"warning"})}this.toggleDiary(e)}else this.showNotification({message:"You cannot change this resource whilst it is being edited.",type:"warning"})},validatedAddDiary(){""!==this.newDiary.name?this.hasDiary?this.showNotification({message:"You may only have one active diary.",type:"warning"}):(this.addDiary(this.newDiary),this.toggleAddingDiaryControls()):this.showNotification({message:"You must provide a description.",type:"warning"})},validatedUpdateResource(){""!==this.editResource.name?(this.updateResource(this.editResource),this.closeEditingResourceControls()):this.showNotification({message:"You must provide a description.",type:"warning"})},validatedUpdateDiary(){""!==this.editDiary.name?this.diary&&this.editDiary.id!==this.diary.id&&!1===this.editDiary.lost?this.showNotification({message:"You may only have one active diary.",type:"warning"}):(this.updateDiary(this.editDiary),this.closeEditingDiaryControls()):this.showNotification({message:"You must provide a description.",type:"warning"})},validatedRemoveResource(){let e;this.resources.some((t=>{if(t.id===this.editResource.id)return e=t,!0})),this.removeResource(e),this.closeEditingResourceControls()},validatedRemoveDiary(){let e;this.diaries.some((t=>{if(t.id===this.editDiary.id)return e=t,!0})),this.removeDiary(e),this.closeEditingDiaryControls()},startEditResource(e){this.editResource=$t(e),this.showEditingResourceControls=!0},startEditDiary(e){this.editDiary=Ot(e),this.showEditingDiaryControls=!0},toggleAddingResourceControls(){this.hideNotification(),this.showAddingResourceControls=!this.showAddingResourceControls,this.newResource=$t()},toggleAddingDiaryControls(){this.hideNotification(),this.showAddingDiaryControls=!this.showAddingDiaryControls,this.newDiary=Ot()},closeEditingResourceControls(){this.hideNotification(),this.showEditingResourceControls=!1,this.editResource=$t()},closeEditingDiaryControls(){this.hideNotification(),this.showEditingDiaryControls=!1,this.editDiary=Ot()}}},Ft=Tt,Zt=o(7645),It=o.n(Zt),Ut=(0,m.Z)(Ft,Rt,St,!1,null,null,null);"function"===typeof It()&&It()(Ut);var Ht=Ut.exports,Bt=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("CardComponent",{attrs:{id:"skills"}},[o("HeadingComponent",{attrs:{level:"2"}},[e._v("Skills")]),o("FormToggleComponent",{attrs:{"show-controls":e.showAddingControls},on:{save:e.validatedAddSkill,toggle:e.toggleAddingControls},scopedSlots:e._u([{key:"button",fn:function(){return[e._v(" Add a new Skill? ")]},proxy:!0},{key:"form",fn:function(){return[o("input",{directives:[{name:"model",rawName:"v-model",value:e.newSkill.name,expression:"newSkill.name"}],staticClass:"shadow appearance-none border rounded w-full py-1 px-2 m-1 text-gray-700 leading-tight focus:outline-none focus:ring-2 ring-gray-200",attrs:{type:"text",placeholder:"Description"},domProps:{value:e.newSkill.name},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.validatedAddSkill.apply(null,arguments)},input:function(t){t.target.composing||e.$set(e.newSkill,"name",t.target.value)}}}),o("label",[o("input",{directives:[{name:"model",rawName:"v-model",value:e.newSkill.checked,expression:"newSkill.checked"}],staticClass:"shadow border rounded py-2 px-2 m-1 text-gray-700 leading-tight focus:outline-none focus:ring-2 ring-gray-200",attrs:{type:"checkbox","true-value":!0,"false-value":!1},domProps:{checked:Array.isArray(e.newSkill.checked)?e._i(e.newSkill.checked,null)>-1:e.newSkill.checked},on:{change:function(t){var o=e.newSkill.checked,r=t.target,i=!!r.checked;if(Array.isArray(o)){var n=null,a=e._i(o,n);r.checked?a<0&&e.$set(e.newSkill,"checked",o.concat([n])):a>-1&&e.$set(e.newSkill,"checked",o.slice(0,a).concat(o.slice(a+1)))}else e.$set(e.newSkill,"checked",i)}}}),e._v(" Checked? ")])]},proxy:!0}])}),o("FormComponent",{directives:[{name:"show",rawName:"v-show",value:e.showEditingControls,expression:"showEditingControls"}],staticClass:"my-2",attrs:{buttons:[{type:"default",event:"save",label:"Save"},{type:"default",event:"cancel",label:"Cancel"},{type:"default",event:"remove",label:"Remove"}]},on:{save:e.validatedUpdateSkill,cancel:e.closeEditingControls,remove:e.validatedRemoveSkill}},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.editSkill.name,expression:"editSkill.name"}],staticClass:"shadow appearance-none border rounded w-full py-1 px-2 m-1 text-gray-700 leading-tight focus:outline-none focus:ring-2 ring-gray-200",attrs:{type:"text",placeholder:"Description"},domProps:{value:e.editSkill.name},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.validatedUpdateSkill.apply(null,arguments)},input:function(t){t.target.composing||e.$set(e.editSkill,"name",t.target.value)}}}),o("label",[o("input",{directives:[{name:"model",rawName:"v-model",value:e.editSkill.checked,expression:"editSkill.checked"}],staticClass:"shadow border rounded py-2 px-2 m-1 text-gray-700 leading-tight focus:outline-none focus:ring-2 ring-gray-200",attrs:{type:"checkbox","true-value":!0,"false-value":!1},domProps:{checked:Array.isArray(e.editSkill.checked)?e._i(e.editSkill.checked,null)>-1:e.editSkill.checked},on:{change:function(t){var o=e.editSkill.checked,r=t.target,i=!!r.checked;if(Array.isArray(o)){var n=null,a=e._i(o,n);r.checked?a<0&&e.$set(e.editSkill,"checked",o.concat([n])):a>-1&&e.$set(e.editSkill,"checked",o.slice(0,a).concat(o.slice(a+1)))}else e.$set(e.editSkill,"checked",i)}}}),e._v(" Checked? ")])]),o("transition-group",{staticClass:"my-2",attrs:{tag:"ul","enter-active-class":"transition-all duration-100 ease-out","leave-active-class":"transition-all duration-100 ease-in","enter-class":"opacity-0","enter-to-class":"opacity-100","leave-class":"opacity-100","leave-to-class":"opacity-0","move-class":"transition-transform duration-500 ease-in-out"}},e._l(e.skills,(function(t){return o("li",{key:"skill-"+t.id,staticClass:"select-none"},[o("div",{staticClass:"grid grid-cols-6"},[o("span",{staticClass:"col-span-5"},[o("span",{staticClass:"cursor-pointer hover:text-gray-400",on:{click:function(o){return e.validatedToggleSkill(t)}}},[o("span",[e._v(e._s(t.name))]),t.checked?o("span",[e._v(" (x) ")]):e._e()])]),o("span",{staticClass:"cursor-pointer select-none flex-initial text-right mx-2 hover:text-gray-400",on:{click:function(o){return e.startEdit(t)}}},[e._v(" Edit ")])])])})),0)],1)},Lt=[];const Yt="skill";var qt=(e={})=>({name:"",checked:!1,...Ee(e,Yt)}),jt={name:"SkillsPane",data:function(){return{showAddingControls:!1,showEditingControls:!1,newSkill:qt(),editSkill:qt()}},components:{CardComponent:g,FormComponent:Ce,FormToggleComponent:Me,HeadingComponent:P},computed:{...(0,re.Se)("skills",["skills"])},methods:{...(0,re.OI)("notifications",{hideNotification:"hide"}),...(0,re.nv)("notifications",["showNotification"]),...(0,re.OI)("skills",["add","remove","toggle","update"]),validatedAddSkill(){""!==this.newSkill.name?(this.add(this.newSkill),this.toggleAddingControls()):this.showNotification({message:"You must provide a description.",type:"warning"})},startEdit(e){this.editSkill=qt(e),this.showEditingControls=!0},validatedToggleSkill(e){this.hideNotification(),this.editSkill.id!==e.id?this.toggle(e):this.showNotification({message:"You cannot change this skill whilst it is being edited.",type:"warning"})},validatedUpdateSkill(){""!==this.editSkill.name?(this.update(this.editSkill),this.closeEditingControls()):this.showNotification({message:"You must provide a description",type:"warning"})},validatedRemoveSkill(){let e;this.skills.some((t=>{if(t.id===this.editSkill.id)return e=t,!0})),this.remove(e),this.closeEditingControls()},toggleAddingControls(){this.hideNotification(),this.showAddingControls=!this.showAddingControls,this.newSkill=qt()},closeEditingControls(){this.hideNotification(),this.showEditingControls=!1,this.editSkill=qt()}}},Jt=jt,zt=(0,m.Z)(Jt,Bt,Lt,!1,null,null,null),Gt=zt.exports,Qt={name:"App",components:{ActionsPane:ue,PromptsPane:qe,MarksPane:We,SkillsPane:Gt,ResourcesPane:Ht,CharactersPane:Fe,HeadingComponent:P,MemoriesPane:wt,NotificationPane:Pt,SlideDownPanelComponent:F},computed:{copyright(){const e=Math.max(2021,(new Date).getUTCFullYear());return`Copyright &copy; ${e} Robin Malburn`}}},Vt=Qt,Kt=(0,m.Z)(Vt,i,n,!1,null,null,null),Wt=Kt.exports;const Xt=(e,t)=>Math.floor(Math.random()*(t-e+1)+e),eo={...Y("actions")},to={die:e=>e.d10-e.d6,currentRoll:(e,t)=>isNaN(t.die)?"?":`${t.die} (+${e.d10}, -${e.d6})`,prompts:e=>{const t=[...e.prompts];return t.sort(((e,t)=>e.page>t.page?-1:1)),t},currentPrompt:e=>e.prompts[e.currentPromptIdx]??{}},oo={rollD6:e=>e.d6=Xt(1,6),setD6:(e,t)=>e.d6=t,setD10:(e,t)=>e.d10=t,rollD10:e=>e.d10=Xt(1,10),saveRoll:(e,t)=>e.lastRoll=t,makePrompt:(e,t)=>e.prompts.push(He({page:t,count:0})),addPrompt:(e,t)=>e.prompts.push(He(t)),setPrompts:(e,t)=>e.prompts=t,removePrompt:(e,t)=>{const o=Se(e.prompts,t.id);e.prompts.splice(o.idx,1)},incrementPrompt:(e,t)=>{const o=Se(e.prompts,t.id);r.Z.set(o.entity,"count",o.entity.count+1)},decrementPrompt:(e,t)=>{const o=Se(e.prompts,t.id);r.Z.set(o.entity,"count",o.entity.count-1)},setCurrentPromptIdx:(e,t)=>e.currentPromptIdx=t},ro={roll:({commit:e,getters:t,state:o})=>{e("saveRoll",t.currentRoll),e("rollD6"),e("rollD10");let r=(t.currentPrompt&&t.currentPrompt.page)??0;r+=t.die,r<=0&&(r=1);var i=o.currentPromptIdx;const n=o.prompts.some(((e,t)=>{if(e.page===r)return i=t,3===e.count&&(i+=1,r+=1),!0}));n||(i=o.prompts.length);var a=o.prompts[i];a||(a=He({page:r}),e("addPrompt",a)),e("incrementPrompt",a),e("setCurrentPromptIdx",i)},makePromptCurrent({commit:e,state:t},o){const r=Se(t.prompts,o.id);e("setCurrentPromptIdx",r.idx)},removePrompt({commit:e,getters:t,state:o},r){const i=t.currentPrompt;e("removePrompt",r);const n=Se(o.prompts,i.id);e("setCurrentPromptIdx",n.idx)}};var io={namespaced:!0,state:eo,getters:to,mutations:oo,actions:ro};const no={...Y("characters")},ao={characters:e=>[...e.characters].sort(((e,t)=>e.dead&&!t.dead?1:!e.dead&&t.dead?-1:e.name.localeCompare(t.name)))},so={add:(e,t)=>e.characters.push(Ne(t)),update:(e,t)=>{const o=Se(e.characters,t.id);r.Z.set(e.characters,o.idx,Ne(t))},set:(e,t)=>e.characters=t,remove:(e,t)=>{const o=Se(e.characters,t.id);e.characters.splice(o.idx,1)},toggle:(e,t)=>{const o=Se(e.characters,t.id);r.Z.set(o.entity,"dead",!o.entity.dead)}};var lo={namespaced:!0,state:no,getters:ao,mutations:so};const co={...Y("marks")},uo={add:(e,t)=>e.marks.push(Ge(t)),update:(e,t)=>{const o=Se(e.marks,t.id);r.Z.set(e.marks,o.idx,Ge(t))},set:(e,t)=>e.marks=t,remove:(e,t)=>{const o=Se(e.marks,t.id);e.marks.splice(o.idx,1)}};var mo={namespaced:!0,state:co,mutations:uo};const po={...Y("memories")},go={active:e=>e.memories.reduce(((e,t)=>!1===t.forgotten&&""===t.diary?e+1:e),0),canAddMemories:(e,t)=>t.active<5,forgottenMemories:e=>e.memories.filter((e=>e.forgotten&&""===e.diary)),activeMemories:e=>e.memories.filter((e=>!e.forgotten&&""===e.diary)),events:e=>t=>e.events.filter((e=>e.memory===t.id)),hasEvents:e=>t=>e.events.some((e=>e.memory===t.id))},ho={addMemory:(e,t)=>e.memories.push(ut(t)),setMemories:(e,t)=>e.memories=t,updateMemory:(e,t)=>{const o=Se(e.memories,t.id);r.Z.set(e.memories,o.idx,ut(t))},removeMemory:(e,t)=>{const o=Se(e.memories,t.id);e.memories.splice(o.idx,1)},toggleMemory:(e,t)=>{const o=Se(e.memories,t.id);r.Z.set(o.entity,"forgotten",!o.entity.forgotten)},addEvent:(e,t)=>e.events.push(mt(t)),setEvents:(e,t)=>e.events=t,updateEvent:(e,t)=>{const o=Se(e.events,t.id);r.Z.set(e.events,o.idx,mt(t))},removeEvent:(e,t)=>{const o=Se(e.events,t.id);e.events.splice(o.idx,1)},diarise:(e,{memory:t,diary:o})=>{const i=Se(e.memories,t.id);r.Z.set(i.entity,"diary",o.id)},undiarise:(e,t)=>{const o=Se(e.memories,t.id);r.Z.set(o.entity,"diary","")}};var yo={namespaced:!0,state:po,getters:go,mutations:ho};const vo={message:"",visible:!1,type:"default"},fo={toggle:e=>e.visible=!e.visible,hide:e=>e.visible=!1,show:e=>e.visible=!0,setMessage:(e,t)=>e.message=t,setType:(e,t)=>e.type=t},Co={showNotification({commit:e},{message:t,type:o}){e("hide"),e("setMessage",t),e("setType",o),e("show")}};var wo={namespaced:!0,state:vo,mutations:fo,actions:Co};const ko={...Y("resources")},xo={resources:e=>[...e.resources].sort(((e,t)=>e.lost&&!t.lost?1:!e.lost&&t.lost?-1:e.name.localeCompare(t.name))),diaries:e=>[...e.diaries].sort(((e,t)=>e.lost&&!t.lost?1:!e.lost&&t.lost?-1:e.name.localeCompare(t.name))),diary:e=>e.diaries.filter((e=>!e.lost))[0]||null,lostDiaries:e=>e.diaries.filter((e=>e.lost)),hasDiary:(e,t)=>null!==t.diary,memories:(e,t,o)=>o.memories.memories.filter((e=>e.diary===t.diary.id)),activeMemories:(e,t)=>t.memories.filter((e=>!e.forgotten)),forgottenMemories:(e,t)=>t.memories.filter((e=>e.forgotten)),isDiaryFull:(e,t)=>{let o=0;return t.memories.some((e=>(e.lost||(o+=1),o>=4)))}},_o={addResource:(e,t)=>e.resources.push($t(t)),setResources:(e,t)=>e.resources=t,updateResource:(e,t)=>{const o=Se(e.resources,t.id);r.Z.set(e.resources,o.idx,$t(t))},removeResource:(e,t)=>{const o=Se(e.resources,t.id);e.resources.splice(o.idx,1)},toggleResource:(e,t)=>{const o=Se(e.resources,t.id);r.Z.set(o.entity,"lost",!o.entity.lost)},addDiary:(e,t)=>e.diaries.push(Ot(t)),updateDiary:(e,t)=>{const o=Se(e.diaries,t.id);r.Z.set(e.diaries,o.idx,Ot(t))},setDiaries:(e,t)=>e.diaries=t,removeDiary:(e,t)=>{const o=Se(e.diaries,t.id);e.diaries.splice(o.idx,1)},toggleDiary:(e,t)=>{const o=Se(e.diaries,t.id);r.Z.set(o.entity,"lost",!o.entity.lost)}};var bo={namespaced:!0,state:ko,getters:xo,mutations:_o};const Mo={...Y("skills")},Ao={skills:e=>[...e.skills].sort(((e,t)=>e.checked&&t.checked||!e.checked&&!t.checked?e.name.localeCompare(t.name):e.checked&&!t.checked?1:-1))},Eo={add:(e,t)=>e.skills.push(qt(t)),set:(e,t)=>e.skills=t,update:(e,t)=>{const o=Se(e.skills,t.id);r.Z.set(e.skills,o.idx,qt(t))},remove:(e,t)=>{const o=Se(e.skills,t.id);e.skills.splice(o.idx,1)},toggle:(e,t)=>{const o=Se(e.skills,t.id);r.Z.set(o.entity,"checked",!o.entity.checked)}};var Po={namespaced:!0,state:Mo,mutations:Eo,getters:Ao};r.Z.use(re.ZP);var Ro=new re.ZP.Store({state:{},mutations:{},actions:{},modules:{actions:io,characters:lo,marks:mo,memories:yo,notifications:wo,resources:bo,skills:Po}});r.Z.config.productionTip=!1,new r.Z({store:Ro,render:e=>e(Wt)}).$mount("#app")}},t={};function o(r){var i=t[r];if(void 0!==i)return i.exports;var n=t[r]={exports:{}};return e[r](n,n.exports,o),n.exports}o.m=e,function(){var e=[];o.O=function(t,r,i,n){if(!r){var a=1/0;for(c=0;c<e.length;c++){r=e[c][0],i=e[c][1],n=e[c][2];for(var s=!0,l=0;l<r.length;l++)(!1&n||a>=n)&&Object.keys(o.O).every((function(e){return o.O[e](r[l])}))?r.splice(l--,1):(s=!1,n<a&&(a=n));if(s){e.splice(c--,1);var d=i();void 0!==d&&(t=d)}}return t}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[r,i,n]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){o.f={},o.e=function(e){return Promise.all(Object.keys(o.f).reduce((function(t,r){return o.f[r](e,t),t}),[]))}}(),function(){o.u=function(e){return"js/"+e+"."+{46:"0e0ac4b9",250:"f0bc37f5",322:"dcd08e41",366:"23b93ac6",572:"cc4c7521",758:"1437fb30",896:"6d0b95ba"}[e]+".js"}}(),function(){o.miniCssF=function(e){}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="tyov:";o.l=function(r,i,n,a){if(e[r])e[r].push(i);else{var s,l;if(void 0!==n)for(var d=document.getElementsByTagName("script"),c=0;c<d.length;c++){var u=d[c];if(u.getAttribute("src")==r||u.getAttribute("data-webpack")==t+n){s=u;break}}s||(l=!0,s=document.createElement("script"),s.charset="utf-8",s.timeout=120,o.nc&&s.setAttribute("nonce",o.nc),s.setAttribute("data-webpack",t+n),s.src=r),e[r]=[i];var m=function(t,o){s.onerror=s.onload=null,clearTimeout(p);var i=e[r];if(delete e[r],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach((function(e){return e(o)})),t)return t(o)},p=setTimeout(m.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=m.bind(null,s.onerror),s.onload=m.bind(null,s.onload),l&&document.head.appendChild(s)}}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){o.p="/tyov/"}(),function(){var e={143:0};o.f.j=function(t,r){var i=o.o(e,t)?e[t]:void 0;if(0!==i)if(i)r.push(i[2]);else{var n=new Promise((function(o,r){i=e[t]=[o,r]}));r.push(i[2]=n);var a=o.p+o.u(t),s=new Error,l=function(r){if(o.o(e,t)&&(i=e[t],0!==i&&(e[t]=void 0),i)){var n=r&&("load"===r.type?"missing":r.type),a=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+n+": "+a+")",s.name="ChunkLoadError",s.type=n,s.request=a,i[1](s)}};o.l(a,l,"chunk-"+t,t)}},o.O.j=function(t){return 0===e[t]};var t=function(t,r){var i,n,a=r[0],s=r[1],l=r[2],d=0;if(a.some((function(t){return 0!==e[t]}))){for(i in s)o.o(s,i)&&(o.m[i]=s[i]);if(l)var c=l(o)}for(t&&t(r);d<a.length;d++)n=a[d],o.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return o.O(c)},r=self["webpackChunktyov"]=self["webpackChunktyov"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=o.O(void 0,[998],(function(){return o(1264)}));r=o.O(r)})();
//# sourceMappingURL=app.16a6f395.js.map