const l={description:"Decouples the nested state of memories, events and diaries.",requiredSignature:2,migrate(s){const t={};s.diaries.forEach(e=>{(e.memories??[]).forEach(i=>{t[i.id]===void 0&&(t[i.id]=[]),t[i.id].push(e)}),delete e.memories}),s.events||(s.events=[]);let n=s.events.length;return s.memories.forEach(e=>{if(e.diarised!==void 0&&delete e.diarised,e.diary===void 0&&(e.diary=""),t[e.id]!==void 0){let i=t[e.id][0];t[e.id].length>1&&i.lost===!0&&t[e.id].some(d=>d.lost===!1?(i=d,!0):!1),e.diary=i.id}e.events.forEach(i=>i.memory=e.id),s.events.splice(n,0,...e.events),n+=e.events.length,delete e.events}),s}};export{l as default};
