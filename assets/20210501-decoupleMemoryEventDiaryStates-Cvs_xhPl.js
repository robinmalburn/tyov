const f={description:"Decouples the nested state of memories, events and diaries.",requiredSignature:2,migrate(s){const n={};s.diaries.forEach(e=>{e.memories.forEach(i=>{n[i.id]===void 0&&(n[i.id]=[]),n[i.id].push(e)}),delete e.memories}),s.events||(s.events=[]);let d=s.events;return s.memories.forEach(e=>{if(e.diarised!==void 0&&delete e.diarised,e.diary===void 0&&(e.diary=""),n[e.id]!==void 0){let i=n[e.id][0];n[e.id].length>1&&i===!1&&n[e.id].some(t=>{t.lost===!1&&(i=t)}),e.diary=i.id}e.events.forEach(i=>i.memory=e.id),s.events.splice(d,0,...e.events),d+=e.events.length,delete e.events}),s}};export{f as default};
